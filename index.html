<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta content="width=device-width,initial-scale=1,minimal-ui" name="viewport">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700,400italic|Material+Icons">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/vue-material@1.0.0-beta-15/dist/vue-material.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/vue-material@1.0.0-beta-15/dist/theme/default.css">
	
	<script src="https://cdn.jsdelivr.net/npm/vue@2.6.12/dist/vue.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/vue-router/3.0.1/vue-router.js"></script>
	<script src="https://cdn.jsdelivr.net/npm/http-vue-loader@1.4.2/src/httpVueLoader.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/vue-material@1.0.0-beta-15/dist/vue-material.min.js"></script>
	<script src="https://cdn.jsdelivr.net/npm/vuelidate@0.7.5/dist/vuelidate.min.js"></script>
	<script src="https://cdn.jsdelivr.net/npm/vuelidate@0.7.5/dist/validators.min.js"></script>
  </head>

  <body>
	<script>
		Vue.component('suggest', httpVueLoader('suggest.vue'));
	</script>

    <div id="app">
		<div>
			<md-tabs md-sync-route class="md-accent" md-alignment="right">
				<md-tab id="tab-home" md-label="Домашняя" to="/">
					<router-view></router-view>
				</md-tab>
				<md-tab id="tab-form" md-label="Форма" to="/form">
					<router-view></router-view>
				</md-tab>
			</md-tabs>
		</div>
    </div>

    <script>
		Vue.use(vuelidate.default);
		var validationMixin = window.vuelidate.validationMixin;
		var required = window.validators.required;
		var minLength = window.validators.minLength;
		var maxLength = window.validators.maxLength;
		var email = window.validators.email;
        Vue.use(VueMaterial.default);

		// home page component
		const HomeComponent = {
			template: `
				<div>Home</div>
			`
		};
		
		// home page component
		const FormComponent = {
			template: `
				<suggest title="Блог" url="https://github.com/unchase/awesome-russian-it/new/master/data/blogs" fields="[{name:'firstName'}]"></suggest>
			`
		};
		
		/*************
		** Routing **
		*************/
		const routes = [
			{ path: "/", component: HomeComponent },
			{ path: "/form", component: FormComponent }
		];
		const router = new VueRouter({
			routes
		});

		const app = new Vue({
			el: '#app',
			router,
			data: () => ({
				form: {
					firstName: 'Иван',
					lastName: 'Иванов',
					description: 'Обычный человек',
					tags: []
				}
			}),
			mixins: [validationMixin],
			validations: {
				form: {
					firstName: {
					  required,
					  minLength: minLength(3)
					},
					lastName: {
					  required,
					  minLength: minLength(3)
					}
				}
			},
			methods: {
				getValidationClass (fieldName) {
					const field = this.$v.form[fieldName]

					if (field) {
						return {
							'md-invalid': field.$invalid && field.$dirty
						}
					}
				},
				clearForm () {
					this.$v.$reset()
					this.form.firstName = null
					this.form.lastName = null
					this.form.description = null
					this.form.tags = []
				},
				saveUser () {
					window.location.href = 'https://github.com/unchase/awesome-russian-it/new/master/data/blogs'
				
					// Instead of this timeout, here you can call your API
					window.setTimeout(() => {
					  this.clearForm()
					}, 1500)
				},
				validateUser () {
					this.$v.$touch()

					if (!this.$v.$invalid) {
					  this.saveUser()

					}
				}
			}
		})
    </script>
  </body>
  
  
</html>