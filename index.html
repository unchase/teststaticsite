<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta content="width=device-width,initial-scale=1,minimal-ui" name="viewport">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700,400italic|Material+Icons">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/vue-material@1.0.0-beta-15/dist/vue-material.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/vue-material@1.0.0-beta-15/dist/theme/default.css">
	
	<script src="https://cdn.jsdelivr.net/npm/vue@2.6.12/dist/vue.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/vue-router/3.0.1/vue-router.js"></script>
	<script src="https://cdn.jsdelivr.net/npm/http-vue-loader@1.4.2/src/httpVueLoader.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/vue-material@1.0.0-beta-15/dist/vue-material.min.js"></script>
	<script src="https://cdn.jsdelivr.net/npm/vuelidate@0.7.5/dist/vuelidate.min.js"></script>
	<script src="https://cdn.jsdelivr.net/npm/vuelidate@0.7.5/dist/validators.min.js"></script>
  </head>

  <body>
	<script>
		Vue.component('appform', httpVueLoader('appform.vue'));
	</script>

    <div id="app">
		<div>
			<md-tabs md-sync-route class="md-accent" md-alignment="right">
				<md-tab id="tab-home" md-label="Домашняя" to="/">
					<router-view></router-view>
				</md-tab>
				<md-tab id="tab-form" md-label="Форма" to="/form">
					<router-view></router-view>
				</md-tab>
			</md-tabs>
		</div>
	
		<!--<div>
			<form novalidate class="md-layout" @submit.prevent="validateUser" @reset.prevent="clearForm">
				<md-card class="md-layout-item md-size-50 md-small-size-100">
					<md-card-header>
						<div class="md-title">Новый пользователь</div>
					</md-card-header>
					<md-card-content>
						<div class="md-layout md-gutter">
							<div class="md-layout-item md-small-size-100">
							<md-field :class="getValidationClass('firstName')">
								<label for="first-name">Имя</label>
								<md-input v-model="form.firstName" name="first-name" id="first-name" required />
								<span class="md-helper-text">Помощь</span>
								<span class="md-error" v-if="!$v.form.firstName.required">The first name is required</span>
								<span class="md-error" v-else-if="!$v.form.firstName.minlength">Invalid first name</span>
							</md-field>
							</div>

							<div class="md-layout-item md-small-size-100">
								<md-field :class="getValidationClass('lastName')">
									<span class="md-prefix">$</span>
									<label for="last-name">Фамилия</label>
									<md-input v-model="form.lastName" name="last-name" id="last-name" />
									<span class="md-error" v-if="!$v.form.lastName.required">Фамилия должна быть задана.</span>
									<span class="md-error" v-else-if="!$v.form.lastName.minlength">Неверная фамилия</span>
								</md-field>
							</div>
						</div>
						<div class="md-layout md-gutter">
							<div class="md-layout-item md-small-size-100">
								<md-field>
									<label for="first-name">Описание</label>
									<md-textarea v-model="form.description" name="description" id="description" />
									<md-icon>description</md-icon>
								</md-field>
							</div>
						</div>
						<div class="md-layout md-gutter">
							<div class="md-layout-item md-small-size-100">
								<md-field>
									<md-chips v-model="form.tags" name="tags" id="tags" class="md-primary" md-placeholder="Добавить тэг..." :md-auto-insert="true">
										<label>Тэги</label>
									</md-chips>
								</md-field>
							</div>
						</div>
					</md-card-content>

					<md-card-actions>
						<md-button class="md-raised" type="reset">СБРОСИТЬ</md-button>
						<md-button class="md-primary" type="submit">СОЗДАТЬ</md-button>
					</md-card-actions>
				</md-card>
			</form>
		</div>-->
    </div>

    <script>
		Vue.use(vuelidate.default);
		var validationMixin = window.vuelidate.validationMixin;
		var required = window.validators.required;
		var minLength = window.validators.minLength;
		var maxLength = window.validators.maxLength;
		var email = window.validators.email;
        Vue.use(VueMaterial.default);

		// home page component
		const HomeComponent = {
			template: `
				<div>Home</div>
			`
		};
		
		// home page component
		const FormComponent = {
			template: `
				<appform></appform>
			`
		};
		
		/*************
		** Routing **
		*************/
		const routes = [
			{ path: "/", component: HomeComponent },
			{ path: "/form", component: FormComponent }
		];
		const router = new VueRouter({
			routes
		});

		const app = new Vue({
			el: '#app',
			router,
			data: () => ({
				form: {
					firstName: 'Иван',
					lastName: 'Иванов',
					description: 'Обычный человек',
					tags: []
				}
			}),
			mixins: [validationMixin],
			validations: {
				form: {
					firstName: {
					  required,
					  minLength: minLength(3)
					},
					lastName: {
					  required,
					  minLength: minLength(3)
					}
				}
			},
			methods: {
				getValidationClass (fieldName) {
					const field = this.$v.form[fieldName]

					if (field) {
						return {
							'md-invalid': field.$invalid && field.$dirty
						}
					}
				},
				clearForm () {
					this.$v.$reset()
					this.form.firstName = null
					this.form.lastName = null
					this.form.description = null
					this.form.tags = []
				},
				saveUser () {
					window.location.href = 'https://github.com/unchase/awesome-russian-it/new/master/data/blogs'
				
					// Instead of this timeout, here you can call your API
					window.setTimeout(() => {
					  this.clearForm()
					}, 1500)
				},
				validateUser () {
					this.$v.$touch()

					if (!this.$v.$invalid) {
					  this.saveUser()

					}
				}
			}
		})
    </script>
  </body>
  
  
</html>